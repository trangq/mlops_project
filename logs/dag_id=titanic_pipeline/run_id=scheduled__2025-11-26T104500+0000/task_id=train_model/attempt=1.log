[2025-11-26T10:52:30.209+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2025-11-26T10:52:30.242+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: titanic_pipeline.train_model scheduled__2025-11-26T10:45:00+00:00 [queued]>
[2025-11-26T10:52:30.252+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: titanic_pipeline.train_model scheduled__2025-11-26T10:45:00+00:00 [queued]>
[2025-11-26T10:52:30.253+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 2
[2025-11-26T10:52:30.271+0000] {taskinstance.py:2330} INFO - Executing <Task(BashOperator): train_model> on 2025-11-26 10:45:00+00:00
[2025-11-26T10:52:30.278+0000] {standard_task_runner.py:63} INFO - Started process 581 to run task
[2025-11-26T10:52:30.283+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'titanic_pipeline', 'train_model', 'scheduled__2025-11-26T10:45:00+00:00', '--job-id', '35', '--raw', '--subdir', 'DAGS_FOLDER/training_pipeline_dag.py', '--cfg-path', '/tmp/tmppvtve155']
[2025-11-26T10:52:30.285+0000] {standard_task_runner.py:91} INFO - Job 35: Subtask train_model
[2025-11-26T10:52:30.310+0000] {warnings.py:109} WARNING - /home/***/.local/lib/python3.10/site-packages/***/settings.py:195: DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
  SQL_ALCHEMY_CONN = conf.get("database", "SQL_ALCHEMY_CONN")

[2025-11-26T10:52:30.386+0000] {task_command.py:426} INFO - Running <TaskInstance: titanic_pipeline.train_model scheduled__2025-11-26T10:45:00+00:00 [running]> on host 86765dc6c081
[2025-11-26T10:52:30.502+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='titanic_pipeline' AIRFLOW_CTX_TASK_ID='train_model' AIRFLOW_CTX_EXECUTION_DATE='2025-11-26T10:45:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-11-26T10:45:00+00:00'
[2025-11-26T10:52:30.503+0000] {taskinstance.py:430} INFO - ::endgroup::
[2025-11-26T10:52:30.545+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-11-26T10:52:30.547+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'python /opt/***/scripts/train_model.py /opt/***/data/cleaned_data.csv']
[2025-11-26T10:52:30.565+0000] {subprocess.py:86} INFO - Output:
[2025-11-26T10:53:43.834+0000] {job.py:218} ERROR - Job heartbeat got an exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3371, in _wrap_pool_connect
    return fn()
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 493, in checkout
    rec = pool._do_get()
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/pool/impl.py", line 256, in _do_get
    return self._create_connection()
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 388, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 690, in __connect
    with util.safe_reraise():
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.10/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
psycopg2.OperationalError: could not translate host name "***-postgres" to address: Temporary failure in name resolution


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/jobs/job.py", line 192, in heartbeat
    self._merge_from(Job._fetch_from_db(self, session))
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/api_internal/internal_api_call.py", line 115, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/utils/session.py", line 76, in wrapper
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/utils/retries.py", line 89, in wrapped_function
    for attempt in run_with_db_retries(max_retries=retries, logger=logger, **retry_kwargs):
  File "/home/airflow/.local/lib/python3.10/site-packages/tenacity/__init__.py", line 435, in __iter__
    do = self.iter(retry_state=retry_state)
  File "/home/airflow/.local/lib/python3.10/site-packages/tenacity/__init__.py", line 368, in iter
    result = action(retry_state)
  File "/home/airflow/.local/lib/python3.10/site-packages/tenacity/__init__.py", line 410, in exc_check
    raise retry_exc.reraise()
  File "/home/airflow/.local/lib/python3.10/site-packages/tenacity/__init__.py", line 183, in reraise
    raise self.last_attempt.result()
  File "/usr/local/lib/python3.10/concurrent/futures/_base.py", line 451, in result
    return self.__get_result()
  File "/usr/local/lib/python3.10/concurrent/futures/_base.py", line 403, in __get_result
    raise self._exception
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/utils/retries.py", line 98, in wrapped_function
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/jobs/job.py", line 316, in _fetch_from_db
    session.merge(job)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 3056, in merge
    return self._merge(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 3136, in _merge
    merged = self.get(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2853, in get
    return self._get_impl(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 2975, in _get_impl
    return db_load_fn(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/orm/loading.py", line 530, in load_on_pk_identity
    session.execute(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/orm/session.py", line 750, in _connection_for_bind
    conn = bind.connect()
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/future/engine.py", line 412, in connect
    return super(Engine, self).connect()
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3325, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 96, in __init__
    else engine.raw_connection()
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3404, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3374, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 2208, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/base.py", line 3371, in _wrap_pool_connect
    return fn()
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 493, in checkout
    rec = pool._do_get()
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/pool/impl.py", line 256, in _do_get
    return self._create_connection()
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 388, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 690, in __connect
    with util.safe_reraise():
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/pool/base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.10/site-packages/sqlalchemy/engine/default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
  File "/home/airflow/.local/lib/python3.10/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) could not translate host name "***-postgres" to address: Temporary failure in name resolution

(Background on this error at: https://sqlalche.me/e/14/e3q8)
[2025-11-26T10:53:58.143+0000] {job.py:226} ERROR - Job heartbeat failed with error. Scheduler is in unhealthy state
[2025-11-26T10:54:00.011+0000] {subprocess.py:93} INFO - 2025/11/26 10:54:00 WARNING mlflow.models.model: `artifact_path` is deprecated. Please use `name` instead.
[2025-11-26T10:54:11.496+0000] {subprocess.py:93} INFO - /home/***/.local/lib/python3.10/site-packages/mlflow/types/utils.py:452: UserWarning: Hint: Inferred schema contains integer column(s). Integer columns in Python cannot represent missing values. If your input data contains missing values at inference time, it will be encoded as floats and will cause a schema enforcement error. The best way to avoid this problem is to infer the model schema based on a realistic data sample (training dataset) that includes missing values. Alternatively, you can declare integer columns as doubles (float64) whenever these columns may have missing values. See `Handling Integers With Missing Values <https://www.mlflow.org/docs/latest/models.html#handling-integers-with-missing-values>`_ for more details.
[2025-11-26T10:54:11.514+0000] {subprocess.py:93} INFO -   warnings.warn(
[2025-11-26T10:54:11.536+0000] {subprocess.py:93} INFO - /home/***/.local/lib/python3.10/site-packages/mlflow/types/utils.py:452: UserWarning: Hint: Inferred schema contains integer column(s). Integer columns in Python cannot represent missing values. If your input data contains missing values at inference time, it will be encoded as floats and will cause a schema enforcement error. The best way to avoid this problem is to infer the model schema based on a realistic data sample (training dataset) that includes missing values. Alternatively, you can declare integer columns as doubles (float64) whenever these columns may have missing values. See `Handling Integers With Missing Values <https://www.mlflow.org/docs/latest/models.html#handling-integers-with-missing-values>`_ for more details.
[2025-11-26T10:54:11.539+0000] {subprocess.py:93} INFO -   warnings.warn(
[2025-11-26T10:55:00.325+0000] {job.py:226} ERROR - Job heartbeat failed with error. Scheduler is in unhealthy state
[2025-11-26T10:55:40.326+0000] {job.py:226} ERROR - Job heartbeat failed with error. Scheduler is in unhealthy state
[2025-11-26T10:56:03.169+0000] {subprocess.py:93} INFO - Loading processed data from: /opt/***/data/cleaned_data.csv
[2025-11-26T10:56:03.190+0000] {subprocess.py:93} INFO - 
[2025-11-26T10:56:03.192+0000] {subprocess.py:93} INFO - === Logging model to MLflow ===
[2025-11-26T10:56:03.193+0000] {subprocess.py:93} INFO - üèÉ View run glamorous-fly-873 at: http://mlflow-server:5000/#/experiments/1/runs/99be3f55430d4268a702ea0affde19d6
[2025-11-26T10:56:03.197+0000] {subprocess.py:93} INFO - üß™ View experiment at: http://mlflow-server:5000/#/experiments/1
[2025-11-26T10:56:03.198+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2025-11-26T10:56:03.199+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.10/site-packages/boto3/s3/transfer.py", line 371, in upload_file
[2025-11-26T10:56:03.200+0000] {subprocess.py:93} INFO -     future.result()
[2025-11-26T10:56:03.206+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.10/site-packages/s3transfer/futures.py", line 103, in result
[2025-11-26T10:56:03.207+0000] {subprocess.py:93} INFO -     return self._coordinator.result()
[2025-11-26T10:56:03.209+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.10/site-packages/s3transfer/futures.py", line 266, in result
[2025-11-26T10:56:03.211+0000] {subprocess.py:93} INFO -     raise self._exception
[2025-11-26T10:56:03.212+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.10/site-packages/s3transfer/tasks.py", line 139, in __call__
[2025-11-26T10:56:03.213+0000] {subprocess.py:93} INFO -     return self._execute_main(kwargs)
[2025-11-26T10:56:03.214+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.10/site-packages/s3transfer/tasks.py", line 162, in _execute_main
[2025-11-26T10:56:03.216+0000] {subprocess.py:93} INFO -     return_value = self._main(**kwargs)
[2025-11-26T10:56:03.217+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.10/site-packages/s3transfer/upload.py", line 764, in _main
[2025-11-26T10:56:03.219+0000] {subprocess.py:93} INFO -     client.put_object(Bucket=bucket, Key=key, Body=body, **extra_args)
[2025-11-26T10:56:03.220+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.10/site-packages/botocore/client.py", line 565, in _api_call
[2025-11-26T10:56:03.221+0000] {subprocess.py:93} INFO -     return self._make_api_call(operation_name, kwargs)
[2025-11-26T10:56:03.222+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.10/site-packages/botocore/client.py", line 1021, in _make_api_call
[2025-11-26T10:56:03.224+0000] {subprocess.py:93} INFO -     raise error_class(parsed_response, operation_name)
[2025-11-26T10:56:03.225+0000] {subprocess.py:93} INFO - botocore.errorfactory.NoSuchBucket: An error occurred (NoSuchBucket) when calling the PutObject operation: The specified bucket does not exist
[2025-11-26T10:56:03.229+0000] {subprocess.py:93} INFO - 
[2025-11-26T10:56:03.230+0000] {subprocess.py:93} INFO - During handling of the above exception, another exception occurred:
[2025-11-26T10:56:03.231+0000] {subprocess.py:93} INFO - 
[2025-11-26T10:56:03.232+0000] {subprocess.py:93} INFO - Traceback (most recent call last):
[2025-11-26T10:56:03.233+0000] {subprocess.py:93} INFO -   File "/opt/***/scripts/train_model.py", line 90, in <module>
[2025-11-26T10:56:03.234+0000] {subprocess.py:93} INFO -     train(sys.argv[1])
[2025-11-26T10:56:03.237+0000] {subprocess.py:93} INFO -   File "/opt/***/scripts/train_model.py", line 57, in train
[2025-11-26T10:56:03.238+0000] {subprocess.py:93} INFO -     model_info = mlflow.sklearn.log_model(
[2025-11-26T10:56:03.239+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.10/site-packages/mlflow/sklearn/__init__.py", line 426, in log_model
[2025-11-26T10:56:03.241+0000] {subprocess.py:93} INFO -     return Model.log(
[2025-11-26T10:56:03.243+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.10/site-packages/mlflow/models/model.py", line 1297, in log
[2025-11-26T10:56:03.246+0000] {subprocess.py:93} INFO -     client.log_model_artifacts(model.model_id, local_path)
[2025-11-26T10:56:03.247+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.10/site-packages/mlflow/tracking/client.py", line 5643, in log_model_artifacts
[2025-11-26T10:56:03.249+0000] {subprocess.py:93} INFO -     return self._tracking_client.log_model_artifacts(model_id, local_dir)
[2025-11-26T10:56:03.252+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.10/site-packages/mlflow/tracking/_tracking_service/client.py", line 911, in log_model_artifacts
[2025-11-26T10:56:03.256+0000] {subprocess.py:93} INFO -     self._get_artifact_repo(model_id, resource="logged_model").log_artifacts(local_dir)
[2025-11-26T10:56:03.257+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.10/site-packages/mlflow/store/artifact/s3_artifact_repo.py", line 299, in log_artifacts
[2025-11-26T10:56:03.259+0000] {subprocess.py:93} INFO -     self._upload_file(
[2025-11-26T10:56:03.263+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.10/site-packages/mlflow/store/artifact/s3_artifact_repo.py", line 247, in _upload_file
[2025-11-26T10:56:03.266+0000] {subprocess.py:93} INFO -     s3_client.upload_file(Filename=local_file, Bucket=bucket, Key=key, ExtraArgs=extra_args)
[2025-11-26T10:56:03.269+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.10/site-packages/boto3/s3/inject.py", line 145, in upload_file
[2025-11-26T10:56:03.271+0000] {subprocess.py:93} INFO -     return transfer.upload_file(
[2025-11-26T10:56:03.273+0000] {subprocess.py:93} INFO -   File "/home/***/.local/lib/python3.10/site-packages/boto3/s3/transfer.py", line 377, in upload_file
[2025-11-26T10:56:03.275+0000] {subprocess.py:93} INFO -     raise S3UploadFailedError(
[2025-11-26T10:56:03.278+0000] {subprocess.py:93} INFO - boto3.exceptions.S3UploadFailedError: Failed to upload /tmp/tmpslloolu6/model/python_env.yaml to mlflow-artifacts/1/models/m-3310fcca89da47ac926a19ba6f0409c3/artifacts/python_env.yaml: An error occurred (NoSuchBucket) when calling the PutObject operation: The specified bucket does not exist
[2025-11-26T10:56:05.938+0000] {subprocess.py:97} INFO - Command exited with return code 1
[2025-11-26T10:56:06.000+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2025-11-26T10:56:08.962+0000] {taskinstance.py:2905} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/taskinstance.py", line 465, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/taskinstance.py", line 432, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/models/baseoperator.py", line 401, in wrapper
    return func(self, *args, **kwargs)
  File "/home/airflow/.local/lib/python3.10/site-packages/airflow/operators/bash.py", line 243, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2025-11-26T10:56:09.008+0000] {taskinstance.py:1206} INFO - Marking task as UP_FOR_RETRY. dag_id=titanic_pipeline, task_id=train_model, run_id=scheduled__2025-11-26T10:45:00+00:00, execution_date=20251126T104500, start_date=20251126T105230, end_date=20251126T105608
[2025-11-26T10:56:09.255+0000] {standard_task_runner.py:110} ERROR - Failed to execute job 35 for task train_model (Bash command failed. The command returned a non-zero exit code 1.; 581)
[2025-11-26T10:56:09.307+0000] {local_task_job_runner.py:240} INFO - Task exited with return code 1
[2025-11-26T10:56:09.466+0000] {taskinstance.py:3503} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-11-26T10:56:09.471+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
